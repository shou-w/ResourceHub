<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600">
  <!-- 背景 -->
  <rect width="800" height="600" fill="#f8f9fa"/>
  
  <!-- タイトル -->
  <text x="400" y="30" font-family="Arial" font-size="20" text-anchor="middle" font-weight="bold">LLMが「日本の首都はどこですか？」に答えるまでの流れ</text>
  
  <!-- ステップ1: 入力の分解（トークン化） -->
  <rect x="50" y="60" width="700" height="80" rx="10" fill="#e6f2ff" stroke="#0066cc" stroke-width="2"/>
  <text x="400" y="85" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">ステップ1: 入力の分解（トークン化）</text>
  <text x="400" y="115" font-family="Arial" font-size="14" text-anchor="middle">「日本」「の」「首都」「は」「どこ」「です」「か」「？」</text>
  
  <!-- 矢印 -->
  <path d="M400 140 L400 170" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- ステップ2: パラメータによる重み付け計算 -->
  <rect x="50" y="170" width="700" height="150" rx="10" fill="#e6ffe6" stroke="#009900" stroke-width="2"/>
  <text x="400" y="195" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">ステップ2: パラメータによる重み付け計算</text>
  
  <!-- 単語間の関連性図 -->
  <circle cx="250" cy="250" r="40" fill="#b3d9ff" stroke="#0066cc" stroke-width="2"/>
  <text x="250" y="255" font-family="Arial" font-size="14" text-anchor="middle">日本</text>
  
  <circle cx="400" cy="250" r="40" fill="#b3d9ff" stroke="#0066cc" stroke-width="2"/>
  <text x="400" y="255" font-family="Arial" font-size="14" text-anchor="middle">首都</text>
  
  <circle cx="550" cy="250" r="40" fill="#b3d9ff" stroke="#0066cc" stroke-width="2"/>
  <text x="550" y="255" font-family="Arial" font-size="14" text-anchor="middle">東京</text>
  
  <!-- 線で単語間の関連性を表現 -->
  <line x1="290" y1="250" x2="360" y2="250" stroke="#333" stroke-width="3"/>
  <text x="325" y="240" font-family="Arial" font-size="12" text-anchor="middle">0.8</text>
  
  <line x1="440" y1="250" x2="510" y2="250" stroke="#333" stroke-width="3"/>
  <text x="475" y="240" font-family="Arial" font-size="12" text-anchor="middle">0.9</text>
  
  <line x1="275" y1="275" x2="525" y2="275" stroke="#333" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="400" y="295" font-family="Arial" font-size="12" text-anchor="middle">0.85</text>
  
  <!-- 矢印 -->
  <path d="M400 320 L400 350" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- ステップ3: 候補の生成と確率計算 -->
  <rect x="50" y="350" width="700" height="120" rx="10" fill="#fff0e6" stroke="#cc6600" stroke-width="2"/>
  <text x="400" y="375" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">ステップ3: 候補の生成と確率計算</text>
  
  <!-- 候補単語と確率 -->
  <rect x="150" y="395" width="120" height="30" rx="5" fill="#ffcc99" stroke="#cc6600" stroke-width="1"/>
  <text x="210" y="415" font-family="Arial" font-size="14" text-anchor="middle">東京: 85%</text>
  
  <rect x="290" y="395" width="120" height="30" rx="5" fill="#ffcc99" stroke="#cc6600" stroke-width="1"/>
  <text x="350" y="415" font-family="Arial" font-size="14" text-anchor="middle">京都: 12%</text>
  
  <rect x="430" y="395" width="120" height="30" rx="5" fill="#ffcc99" stroke="#cc6600" stroke-width="1"/>
  <text x="490" y="415" font-family="Arial" font-size="14" text-anchor="middle">大阪: 2%</text>
  
  <rect x="570" y="395" width="120" height="30" rx="5" fill="#ffcc99" stroke="#cc6600" stroke-width="1"/>
  <text x="630" y="415" font-family="Arial" font-size="14" text-anchor="middle">パリ: 1%</text>
  
  <!-- 矢印 -->
  <path d="M400 470 L400 500" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- ステップ4: 最終回答の生成 -->
  <rect x="200" y="500" width="400" height="60" rx="10" fill="#f2e6ff" stroke="#6600cc" stroke-width="2"/>
  <text x="400" y="525" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">ステップ4: 最終回答</text>
  <text x="400" y="545" font-family="Arial" font-size="14" text-anchor="middle">「日本の首都は東京です」</text>
  
  <!-- 矢印のマーカー定義 -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
  </defs>
</svg>